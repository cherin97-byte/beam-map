<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>1F 부재 위치 맵</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" defer></script>

  <style>
    html, body { height: 100%; margin: 0; }
    #map { height: 100%; width: 100%; }
    .hint {
      position: absolute; z-index: 9999; left: 10px; top: 10px;
      background: rgba(255,255,255,0.9); padding: 8px 10px; border-radius: 8px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      font-size: 14px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.15);
    }
  </style>
</head>
<body>
  <div class="hint">
    도면을 드래그/확대 가능<br/>
    도면 클릭 시 좌표가 콘솔에 출력됩니다.
  </div>
  <div id="map"></div>

  <script>
    window.addEventListener("load", () => {
      const imageUrl = "floor_1f.png";

      // ✅ 도면 이미지 실제 픽셀 크기(아래 4)에서 자동 확인)
      const IMAGE_WIDTH = 1231;
      const IMAGE_HEIGHT = 740;

      const map = L.map("map", {
        crs: L.CRS.Simple,
        minZoom: -2,
        maxZoom: 2,
        zoomSnap: 0.25,
        zoomDelta: 0.25
      });

      const bounds = [[0, 0], [IMAGE_HEIGHT, IMAGE_WIDTH]];
      L.imageOverlay(imageUrl, bounds).addTo(map);
      map.fitBounds(bounds);

      const beams = [
        { id: "B12", x: 820, y: 520, status: "출하완료" },
        { id: "B13", x: 910, y: 540, status: "미출하" },
        { id: "G07", x: 320, y: 260, status: "출하완료" },
      ];

      beams.forEach(b => {
        const marker = L.circleMarker([b.y, b.x], { radius: 8 }).addTo(map);
        marker.bindPopup(`<b>${b.id}</b><br/>상태: ${b.status}<br/><small>(${b.x}, ${b.y})</small>`);
      });

      map.on("click", (e) => {
        const x = Math.round(e.latlng.lng);
        const y = Math.round(e.latlng.lat);
        console.log("CLICK XY =", { x, y });
      });
    });
  </script>
</body>
</html>
